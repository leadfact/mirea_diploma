FROM zabbix/zabbix-server-mysql:latest

# Switch to root for installation
USER root

# Copy entrypoint script
COPY docker-entrypoint.sh /usr/local/bin/
RUN chmod +x /usr/local/bin/docker-entrypoint.sh

# Create necessary directories and set permissions
RUN mkdir -p /var/run/zabbix /var/log/zabbix && \
    chown -R zabbix:zabbix /var/run/zabbix /var/log/zabbix && \
    chmod 755 /var/run/zabbix /var/log/zabbix

# Switch to zabbix user
USER zabbix 