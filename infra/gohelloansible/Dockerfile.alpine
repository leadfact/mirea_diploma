FROM alpine:latest

RUN apk add --no-cache openssh go

# Создаем пользователя и настраиваем SSH
RUN adduser -D ansible && \
    echo "ansible:ansible" | chpasswd && \
    mkdir -p /home/ansible/.ssh && \
    chown -R ansible:ansible /home/ansible/.ssh && \
    echo "PermitRootLogin yes\nPasswordAuthentication yes\n" >> /etc/ssh/sshd_config

EXPOSE 22

CMD ["/usr/sbin/sshd", "-D"]
